#  DOCUMENTACIN EXHAUSTIVA DEL PROYECTO: Mentapp (v. 1.0. FINAL)

## ESTADO DEL PROYECTO: COMPLETO Y ROBUSTO (Solo Pendiente la Publicaci贸n)

(Este resumen consolida todas las funcionalidades, *fixes* y arquitectura de compatibilidad aplicadas, excluyendo el c贸digo PHP).

---

### 1. Prop贸sito y Visi贸n Art铆stica (El "Porqu茅")

* **Prop贸sito:** Crear una app nativa en Android (Kotlin/Jetpack Compose) para el proyecto musical "Mentat".
* **Visi贸n Art铆stica:** Experiencia visual "impactante", moderna y "Ambient". Interfaz 100% personalizada, fluida y "f铆sica" (con peso, rebotes y confirmaci贸n t谩ctil).
* **Dise帽o Clave y Soluciones Aplicadas:**
    * **Respuesta de Pantalla:** La app es **FULL RESPONSIVA** (maneja Portrait y Landscape), con layouts ajustados v铆a `BoxWithConstraints` (arreglando el bug de clipping del icono flotante).
    * **Feedback T谩ctil (FIX):** Implementado **Haptic Feedback** (`VibrationHelper.kt`) con vibraci贸n "pesada" para clics de acci贸n y vibraci贸n "ligera" para el *snap* del carrusel.
    * **Inactividad (FIX):** Iconos inactivos con filtro de **Oscurecimiento (Darken Matrix)**, eliminando el tono viol谩ceo de la desaturaci贸n.
    * **Cierre Limpio:** Bot贸n "Power" discreto con **"Apagado Fuerte"** (`finishAndRemoveTask()` + `exitProcess(0)`).

---

### 2. Stack Tecnol贸gico y Compatibilidad

| Componente | Tecnolog铆a / Patr贸n | Comentarios / Soluciones Aplicadas |
| :--- | :--- | :--- |
| **Lenguaje/UI** | Kotlin / Jetpack Compose M3 | 100% Compose, sin XML. |
| **Compatibilidad** | `if (Build.VERSION.SDK_INT)` | **Degradaci贸n Elegante:** Soporte funcional garantizado desde API 28 (Pie). Resuelto el conflicto de `RuntimeShader` (API 33) y `Modifier.blur` (API 31). |
| **Estado** | `ViewModel` + `SavedStateHandle` | **State Hoisting:** Se utiliza para sincronizar la posici贸n del carrusel (`currentPage`) y el dial a trav茅s de la navegaci贸n y la rotaci贸n. |
| **Red** | Ktor + Kotlinx Serialization | Lectura de dos fuentes (JSON principal y `concepto.json` remoto) y traducci贸n de datos en el ViewModel. |
| **UX Inmersiva** | `WindowInsetsControllerCompat` | **Modo Inmersivo Sticky** (barras ocultas que aparecen al deslizar) para todas las APIs. |

---

### 3. Estructura y L贸gica (El "Cerebro" y los "Actores")

#### A. Capa de ViewModel (`ui/screens/home/viewmodel/`)

* **`HomeViewModel.kt` (El Cerebro):** Es la **nica Fuente de Verdad (SSOT)**.
    * **Estado Hoisting:** Expone `currentPage: State<Int>` y `rotationAngle: StateFlow<Float>` que mantienen la sincronizaci贸n bidireccional del Dial.
    * **L贸gica de Datos:** Llama a dos fuentes de red, traduce la estructura `ConceptItem` a `CarouselItem` y realiza la fusi贸n de datos en una sola estructura `AppData`.
    * **Limpieza:** Se eliminaron las estructuras de datos obsoletas (`ConceptBlock`) y su l贸gica polim贸rfica.

#### B. Componentes de UI Modulares (`ui/composables/`)

| Archivo | Prop贸sito | Detalles de Implementaci贸n Clave |
| :--- | :--- | :--- |
| **`AttractorBackground.kt`** | **El Fondo (B煤nker)** | Contiene el `RuntimeShader` (API 33), aislado para compatibilidad. |
| **`CircularDialLayout.kt`** | **El Dial** | Implementaci贸n del filtro de color **Oscurecimiento** para iconos inactivos y la l贸gica de la sombra con `if/else` por API. |
| **`VibrationHelper.kt`** | **Motor T谩ctil** | Clase de utilidad que usa el potente `Vibrator` del sistema para ofrecer vibraciones "secas" y personalizadas (reemplazando los d茅biles *presets* de `HapticFeedback`). |
| **`AlbumCarousel.kt`** | **El Carrusel** | **Layout Concepto:** Implementaci贸n de `isConceptMode`. El layout ahora es un rect谩ngulo alto, y el cuerpo del texto (`item.artist`) es **scrolleable** (`verticalScroll`). **Alineaci贸n:** Usa `minLines = 2` en el t铆tulo (Modo Disco) para garantizar la alineaci贸n visual en diferentes densidades de pantalla. |
| **`VideoBackground.kt`** | **Fallback de Fondo** | Implementaci贸n de `TextureView` y `ExoPlayer` con `RESIZE_MODE_ZOOM` para garantizar el llenado de pantalla en APIs < 33. |

#### C. El Director (`ui/screens/home/HomeScreen.kt`)

* **Coreograf铆a:** Contiene la l贸gica `onIconClick` y `BackHandler` simplificada.
* **L贸gica de Presentaci贸n:** Utiliza el Composable `AlbumCarousel` de forma condicional, pasando el estado `initialPage` y el *callback* `onPageChanged` para mantener la sincronizaci贸n con el `ViewModel`.

---

### 4. Tareas Pendientes (El "Roadmap" Futuro)


1.  **Pr贸xima Versi贸n (2.0):** Planificaci贸n del "Lado B" (el segundo dial) y el contenido exclusivo/de suscripci贸n.